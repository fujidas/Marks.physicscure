<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Physicks Cure Mentor - Admin Panel</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

  <style>
    body {
      background: radial-gradient(circle at top, #1a1a2e, #0f0f1f 80%);
      font-family: 'Segoe UI', sans-serif;
      color: #e0e0e0;
    }

    .container {
      background: rgba(25, 25, 35, 0.9);
      padding: 30px;
      border-radius: 20px;
      margin-top: 40px;
      box-shadow: 0px 10px 40px rgba(0, 255, 255, 0.3);
      border: 1px solid rgba(0, 255, 255, 0.2);
    }

    h2 {
      font-weight: bold;
      text-align: center;
      color: #00ffff;
      text-shadow: 0 0 10px #00ffff, 0 0 30px #0088ff;
    }

    .btn {
      border: none;
      border-radius: 12px;
      font-weight: bold;
      color: white;
      transition: all 0.3s ease-in-out;
    }

    .btn-success {
      background: linear-gradient(90deg, #00b894, #00cec9);
      box-shadow: 0 0 10px #00cec9;
    }

    .btn-warning {
      background: linear-gradient(90deg, #ff9f1a, #ff6f00);
      color: #222;
      box-shadow: 0 0 10px #ff9f1a;
    }

    .btn-danger {
      background: linear-gradient(90deg, #d63031, #ff4757);
      box-shadow: 0 0 10px #ff4757;
    }

    .btn-info {
      background: linear-gradient(90deg, #0984e3, #00cec9);
      box-shadow: 0 0 10px #0984e3;
    }

    thead {
      background: linear-gradient(90deg, #00b894, #00cec9, #0984e3);
      color: white;
    }

    /* ‚úÖ Dark Mode Table */
    .table {
      background-color: #1e1e2f !important;
      color: #e0e0e0 !important;
      border-collapse: collapse;
    }

    .table th,
    .table td {
      border: 1px solid #333 !important;
      text-align: center;
      vertical-align: middle;
    }

    .table-striped tbody tr:nth-child(odd) {
      background-color: #252535 !important;
    }

    .table-striped tbody tr:nth-child(even) {
      background-color: #2d2d40 !important;
    }

    .table-striped tbody tr:hover {
      background: rgba(0, 255, 255, 0.1) !important;
      transform: scale(1.01);
      transition: 0.3s;
      box-shadow: 0px 5px 15px rgba(0, 255, 255, 0.3);
      color: #ffffff !important;
    }

    .logo-banner {
      max-width: 160px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 0 20px #00ffff;
    }

    .modal-content {
      background: #1a1a2e;
      color: #eee;
      border: 1px solid #00ffff;
      box-shadow: 0 0 20px #00ffff;
    }

    .modal-header {
      border-bottom: 1px solid #00ffff;
    }

    /* üîç Neon Search */
    #searchInput {
      padding: 10px;
      width: 60%;
      border-radius: 8px;
      border: 1px solid #00ffff;
      background: #111;
      color: #00ffff;
      margin-bottom: 20px;
      text-align: center;
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.6);
      transition: all 0.3s ease;
    }

    #searchInput:focus {
      outline: none;
      box-shadow: 0 0 25px rgba(0, 255, 255, 1);
    }

    /* ‚ú® Neon Edit & Delete */
    .btn-edit {
      background: linear-gradient(90deg, #00ffcc, #00bfff);
      color: #0d0d1a !important;
      font-weight: bold;
      border: none;
      padding: 6px 14px;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(0, 255, 255, 0.8);
      transition: all 0.3s ease;
    }

    .btn-edit:hover {
      background: linear-gradient(90deg, #00bfff, #00ffcc);
      color: #ffffff !important;
      box-shadow: 0 0 20px rgba(0, 255, 255, 1);
      transform: scale(1.05);
    }

    .btn-delete {
      background: linear-gradient(90deg, #ff4d4d, #ff0000);
      color: #fff !important;
      font-weight: bold;
      border: none;
      padding: 6px 14px;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(255, 0, 0, 0.8);
      transition: all 0.3s ease;
    }

    .btn-delete:hover {
      background: linear-gradient(90deg, #ff0000, #ff4d4d);
      color: #fff !important;
      box-shadow: 0 0 20px rgba(255, 0, 0, 1);
      transform: scale(1.05);
    }
  </style>
</head>

<body>
  <div class="container">
    <!-- ‚úÖ Logo -->
    <div class="text-center">
      <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" class="logo-banner">
    </div>

    <h2>üåô Physicks Cure Mentor - Admin Panel</h2>

    <!-- üîë Change Password + üö™ Logout -->
    <div class="text-end mb-3">
      <a href="{{ url_for('change_password') }}" class="btn btn-warning me-2">üîë Change Password</a>
      <a href="{{ url_for('logout') }}" class="btn btn-danger">üö™ Logout</a>
    </div>
    <hr>

    <!-- ‚úÖ Manage Homepage Images (Collapsible) -->
    <div class="mb-3 text-center">
      <button class="btn btn-info" type="button" data-bs-toggle="collapse" data-bs-target="#manageImages" aria-expanded="false" aria-controls="manageImages">
        üì∏ Manage Homepage Images
      </button>
    </div>

    <div class="collapse" id="manageImages">
      <div class="card card-body bg-dark border border-info shadow-lg">
        <!-- Upload form -->
        <form method="POST" enctype="multipart/form-data" class="mb-3">
          <input type="hidden" name="action" value="upload_image">
          <input type="file" name="image" accept="image/*" required class="form-control mb-2">
          <button type="submit" class="btn btn-primary btn-sm">Upload</button>
        </form>

        <!-- Show uploaded images -->
        <div class="row mt-3">
          {% for img in images %}
          <div class="col-md-3 text-center mb-3">
            <img src="{{ url_for('static', filename='uploads/' ~ img) }}" class="img-fluid rounded shadow border border-info">
            <form method="POST" class="mt-2">
              <input type="hidden" name="action" value="delete_image">
              <input type="hidden" name="filename" value="{{ img }}">
              <button type="submit" class="btn btn-danger btn-sm">Delete</button>
            </form>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
    <hr>

    <!-- ‚úÖ Add Student Form -->
    <div class="card p-4 mb-4 bg-dark border border-info shadow-lg">
      <h4 class="mb-3 fw-bold text-center text-info">
        <i class="bi bi-person-plus-fill"></i> Add New Student
      </h4>
      <form method="POST">
        <input type="hidden" name="action" value="add">
        <div class="row g-3">
          <div class="col-md-6"><input class="form-control" type="text" name="name" placeholder="üë§ Student Name" required></div>
          <div class="col-md-6"><input class="form-control" type="text" name="class" placeholder="üéì Class" required></div>
          <div class="col-md-6"><input class="form-control" type="text" name="phone" placeholder="üì± Student Phone" required></div>
          <div class="col-md-6"><input class="form-control" type="text" name="guardian_phone" placeholder="üë®‚Äçüë© Guardian Phone" required></div>
          <div class="col-12"><input class="form-control" type="text" name="school" placeholder="üè´ School" required></div>

          <h5 class="mt-3 text-success">üìä Mock Tests</h5>
          <div class="col-md-3"><input class="form-control" type="number" name="mock_test1" placeholder="Mock 1 Marks"></div>
          <div class="col-md-3"><input class="form-control" type="number" name="mock_test1_full" placeholder="Mock 1 Full"></div>
          <div class="col-md-3"><input class="form-control" type="number" name="mock_test2" placeholder="Mock 2 Marks"></div>
          <div class="col-md-3"><input class="form-control" type="number" name="mock_test2_full" placeholder="Mock 2 Full"></div>
          <div class="col-md-3"><input class="form-control" type="number" name="mock_test3" placeholder="Mock 3 Marks"></div>
          <div class="col-md-3"><input class="form-control" type="number" name="mock_test3_full" placeholder="Mock 3 Full"></div>
          <div class="col-md-3"><input class="form-control" type="number" name="mock_test4" placeholder="Mock 4 Marks"></div>
          <div class="col-md-3"><input class="form-control" type="number" name="mock_test4_full" placeholder="Mock 4 Full"></div>
        </div>
        <div class="text-center mt-4">
          <button class="btn btn-lg px-5 btn-info"><i class="bi bi-plus-circle"></i> Add Student</button>
        </div>
      </form>
    </div>

    <!-- ‚úÖ Students Table -->
    <div class="table-responsive">
      <!-- üîç Search bar -->
      <div class="text-center">
        <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="üîç Search by any field...">
      </div>

      <table id="studentTable" class="table table-bordered table-striped text-center align-middle shadow-sm">
        <thead>
          <tr>
            <th>#</th><th>üë§ Name</th><th>üéì Class</th>
            <th>Mock1</th><th>Mock1 Full</th>
            <th>Mock2</th><th>Mock2 Full</th>
            <th>Mock3</th><th>Mock3 Full</th>
            <th>Mock4</th><th>Mock4 Full</th>
            <th>üì± Phone</th><th>üë®‚Äçüë© Guardian Phone</th><th>üè´ School</th><th>‚öôÔ∏è Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for s in students %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ s.name }}</td>
            <td>{{ s.student_class }}</td>
            <td>{{ s.mock_test1 }}</td>
            <td>{{ s.mock_test1_full }}</td>
            <td>{{ s.mock_test2 }}</td>
            <td>{{ s.mock_test2_full }}</td>
            <td>{{ s.mock_test3 }}</td>
            <td>{{ s.mock_test3_full }}</td>
            <td>{{ s.mock_test4 }}</td>
            <td>{{ s.mock_test4_full }}</td>
            <td>{{ s.phone }}</td>
            <td>{{ s.guardian_phone }}</td>
            <td>{{ s.school }}</td>
            <td>
              <button class="btn-edit btn-sm" data-bs-toggle="modal" data-bs-target="#editModal{{ s.id }}">‚úèÔ∏è Edit</button>
              <form method="POST" style="display:inline;">
                <input type="hidden" name="action" value="delete">
                <input type="hidden" name="id" value="{{ s.id }}">
                <button class="btn-delete btn-sm">üóëÔ∏è Delete</button>
              </form>
            </td>
          </tr>

          <!-- ‚úÖ Edit Modal -->
          <div class="modal fade" id="editModal{{ s.id }}" tabindex="-1">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header bg-info text-dark">
                  <h5 class="modal-title">‚úèÔ∏è Edit Student</h5>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                  <form method="POST">
                    <input type="hidden" name="action" value="edit">
                    <input type="hidden" name="id" value="{{ s.id }}">
                    <input type="text" class="form-control mb-2" name="name" value="{{ s.name }}" required>
                    <input type="text" class="form-control mb-2" name="class" value="{{ s.student_class }}" required>
                    <input type="text" class="form-control mb-2" name="phone" value="{{ s.phone }}" required>
                    <input type="text" class="form-control mb-2" name="guardian_phone" value="{{ s.guardian_phone }}" required>
                    <input type="text" class="form-control mb-2" name="school" value="{{ s.school }}" required>
                    <div class="row g-2">
                      <div class="col-md-3"><input type="number" class="form-control" name="mock_test1" value="{{ s.mock_test1 }}"></div>
                      <div class="col-md-3"><input type="number" class="form-control" name="mock_test1_full" value="{{ s.mock_test1_full }}"></div>
                      <div class="col-md-3"><input type="number" class="form-control" name="mock_test2" value="{{ s.mock_test2 }}"></div>
                      <div class="col-md-3"><input type="number" class="form-control" name="mock_test2_full" value="{{ s.mock_test2_full }}"></div>
                      <div class="col-md-3"><input type="number" class="form-control" name="mock_test3" value="{{ s.mock_test3 }}"></div>
                      <div class="col-md-3"><input type="number" class="form-control" name="mock_test3_full" value="{{ s.mock_test3_full }}"></div>
                      <div class="col-md-3"><input type="number" class="form-control" name="mock_test4" value="{{ s.mock_test4 }}"></div>
                      <div class="col-md-3"><input type="number" class="form-control" name="mock_test4_full" value="{{ s.mock_test4_full }}"></div>
                    </div>
                    <button class="btn btn-warning w-100 mt-3">üíæ Save Changes</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- üîç Search Script -->
  <script>
    function searchTable() {
      let input = document.getElementById("searchInput").value.toLowerCase();
      let table = document.getElementById("studentTable");
      let rows = table.getElementsByTagName("tr");

      for (let i = 1; i < rows.length; i++) {
        let cells = rows[i].getElementsByTagName("td");
        let found = false;
        for (let j = 0; j < cells.length; j++) {
          if (cells[j]) {
            let textValue = cells[j].textContent || cells[j].innerText;
            if (textValue.toLowerCase().indexOf(input) > -1) {
              found = true;
              break;
            }
          }
        }
        rows[i].style.display = found ? "" : "none";
      }
    }
  </script>
</body>
</html>